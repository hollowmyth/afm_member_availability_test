<!DOCTYPE html>
<html>
  <head>
    <title>Sheets API Quickstart</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <p>Sheets API Quickstart</p>

    <!--Add buttons to initiate auth sequence and sign out-->
    <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
    <button id="signout_button" onclick="handleSignoutClick()">Sign Out</button>

    <pre id="content" style="white-space: pre-wrap;"></pre>
    
    <h1>RESULT</h1>
  <table>
    <thead>
      <!-- <tr>
        <th>&nbsp;</th>
        <th>Sun</th>
        <th>Mon</th>
        <th>Tue</th>
        <th>Wed</th>
        <th>Thu</th>
        <th>Fri</th>
        <th>Sat</th>
      </tr> -->
      <th>date</th>
      <th>name</th>
      <th>Sun</th>
      <th>Mon</th>
      <th>Tue</th>
      <th>Wed</th>
    </thead>
    <tbody id="result">

    </tbody>
  </table>

<script>
   const onSuccess = data => {
     const result = document.getElementById('result')
     const userArr = JSON.parse(data).data
     userArr.forEach(user=>{
       //result.innerHTML += `<tr><td>${user[0]}</td><td>${user[1]}</td><td>${user[2]}</td><td>${user[3]}</td><td>${user[4]}</td><td>${user[5]}</td></tr>\n`
       result.innerHTML += `<tr><td>${user[0]}</td><td>${user[2]}</td><td>${user[7]}</td><td>${user[8]}</td><td>${user[9]}</td><td>${user[10]}</td></tr>\n`
     })
   }
   /*google.script.run
     .withSuccessHandler(onSuccess)
     .fetchData()*/
     
    async function fetchJsonData(url) {
  try {
    const response = await fetch(url); // Make the GET request
    
    // Check if the request was successful (status code 200-299)
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const jsonData = await response.json(); // Parse the JSON response
    return jsonData;
  } catch (error) {
    console.error("Error fetching or parsing JSON:", error);
    return null; // Handle the error appropriately
  }
}

// Example usage:
const apiUrl = 'https://script.google.com/macros/s/AKfycbzBzLDI0H-fZLaq4_M1LqDT2PhyS741smdCOIIFBpp48aVjaIKJUIfUWBtHYjKLUmBw/exec'; // Replace with your API endpoint
fetchJsonData(apiUrl)
  .then(data => {
    if (data) {
        const result = document.getElementById('result');
        const arrMember = data.data; 
        arrMember.forEach(member=>{
            result.innerHTML += `<tr><td>${member[0]}</td><td>${member[2]}</td><td>${member[7]}</td><td>${member[8]}</td><td>${member[9]}</td><td>${member[10]}</td></tr>\n`
        })
      console.log("Fetched JSON data:", data);
    }
  });
</script>

  </body>
</html>
